import{i,r as s,j as e,c as Z}from"./core-CJ1JWWxS.js";var C;(function(a){a.Nsis="nsis",a.Msi="msi",a.Deb="deb",a.Rpm="rpm",a.AppImage="appimage",a.App="app"})(C||(C={}));async function B(){return i("plugin:app|version")}function c(){return typeof window>"u"?!1:typeof window.__TAURI_INTERNALS__?.invoke=="function"}function u(a){return a instanceof Error&&a.message?a.message:typeof a=="string"&&a.length>0?a:"Unknown error"}function ee(){const[a,g]=s.useState(""),[N,O]=s.useState(!1),[d,m]=s.useState(""),[P,D]=s.useState(!1),[v,S]=s.useState(!1),[G,T]=s.useState("..."),[U,b]=s.useState(!1),[L,w]=s.useState(!0),[M,k]=s.useState(!0),[x,A]=s.useState(!0),[j,K]=s.useState(!0),[$,_]=s.useState(!1),[F,I]=s.useState(!1),[p,o]=s.useState("idle"),[h,l]=s.useState("idle"),[E,n]=s.useState(""),y=async()=>{w(!0);try{if(!c())throw new Error("Tauri runtime unavailable. Open this UI from the Air Keys tray app.");const t=await i("has_deepgram_api_key");O(t)}finally{w(!1)}},R=async()=>{K(!0);try{if(!c())throw new Error("Tauri runtime unavailable. Open this UI from the Air Keys tray app.");const t=await i("get_launch_on_startup_enabled");b(t)}finally{K(!1)}},f=async()=>{k(!0);try{if(!c())throw new Error("Tauri runtime unavailable. Open this UI from the Air Keys tray app.");const t=await i("has_gemini_api_key");D(t)}finally{k(!1)}},V=async()=>{A(!0);try{if(!c())throw new Error("Tauri runtime unavailable. Open this UI from the Air Keys tray app.");const t=await i("get_processing_enabled");S(t)}finally{A(!1)}};s.useEffect(()=>{const t=window.setTimeout(()=>{Promise.all([y(),R(),f(),V(),B().then(r=>T(r))]).catch(r=>{o("error"),n(u(r))})},0);return()=>window.clearTimeout(t)},[]);const W=s.useMemo(()=>{switch(p){case"saving":return"Saving...";case"saved":return"Saved";default:return"Save key"}},[p]),H=s.useMemo(()=>{switch(h){case"saving":return"Saving...";case"saved":return"Saved";default:return"Save key"}},[h]);async function z(t){if(t.preventDefault(),!a.trim()){o("error"),n("Enter a Deepgram API key before saving.");return}try{if(o("saving"),n(""),!c())throw new Error("Tauri runtime unavailable. Open this UI from the Air Keys tray app.");await i("save_deepgram_api_key",{apiKey:a}),g(""),await y(),o("saved")}catch(r){o("error"),n(`Air Keys could not save the API key: ${u(r)}`)}}async function q(){try{if(!c())throw new Error("Tauri runtime unavailable. Open this UI from the Air Keys tray app.");await i("clear_deepgram_api_key"),g(""),o("idle"),n(""),await y()}catch(t){o("error"),n(`Air Keys could not clear the API key: ${u(t)}`)}}async function J(t){if(t.preventDefault(),!d.trim()){l("error"),n("Enter a Gemini API key before saving.");return}try{if(l("saving"),n(""),!c())throw new Error("Tauri runtime unavailable. Open this UI from the Air Keys tray app.");await i("save_gemini_api_key",{apiKey:d}),m(""),await f(),l("saved")}catch(r){l("error"),n(`Air Keys could not save the API key: ${u(r)}`)}}async function Q(){try{if(!c())throw new Error("Tauri runtime unavailable. Open this UI from the Air Keys tray app.");await i("clear_gemini_api_key"),m(""),l("idle"),n(""),await f()}catch(t){l("error"),n(`Air Keys could not clear the API key: ${u(t)}`)}}async function X(t){try{if(_(!0),n(""),!c())throw new Error("Tauri runtime unavailable. Open this UI from the Air Keys tray app.");await i("set_launch_on_startup_enabled",{enabled:t}),b(t)}catch(r){o("error"),n(`Air Keys could not update launch on startup: ${u(r)}`)}finally{_(!1)}}async function Y(t){try{if(I(!0),n(""),!c())throw new Error("Tauri runtime unavailable. Open this UI from the Air Keys tray app.");await i("set_processing_enabled",{enabled:t}),S(t)}catch(r){o("error"),n(`Air Keys could not update processing: ${u(r)}`)}finally{I(!1)}}return e.jsxs("main",{className:"settings-shell",children:[e.jsx("h1",{children:"Air Keys settings"}),e.jsx("p",{className:"settings-subtitle",children:"Press Alt twice to start/stop dictation."}),e.jsx("p",{className:"settings-help",children:"Air Keys runs from the system tray. Configure your transcription and post-processing keys here."}),e.jsxs("section",{className:"settings-section",children:[e.jsxs("form",{className:"settings-form",onSubmit:z,children:[e.jsx("label",{htmlFor:"deepgramKey",children:"Deepgram API key"}),e.jsx("input",{id:"deepgramKey",type:"password",autoComplete:"off",spellCheck:!1,value:a,onChange:t=>{g(t.target.value),p!=="idle"&&o("idle")},placeholder:"dg_live_..."}),e.jsxs("div",{className:"settings-actions",children:[e.jsx("button",{type:"submit",disabled:p==="saving",children:W}),e.jsx("button",{type:"button",onClick:q,children:"Clear key"})]})]}),e.jsxs("p",{className:"settings-status",children:["Stored key:"," ",e.jsx("strong",{children:L?"checking...":N?"present":"not set"})]})]}),e.jsxs("section",{className:"settings-section",children:[e.jsx("h2",{children:"General"}),e.jsxs("label",{className:"settings-checkbox",htmlFor:"launchOnStartup",children:[e.jsx("input",{id:"launchOnStartup",type:"checkbox",checked:U,disabled:j||$,onChange:t=>{X(t.target.checked)}}),"Launch on startup"]}),e.jsx("p",{className:"settings-muted",children:j?"Checking startup setting...":"When enabled, Air Keys starts when you sign in to Windows."})]}),e.jsxs("section",{className:"settings-section",children:[e.jsx("h2",{children:"Post-processing"}),e.jsxs("label",{className:"settings-checkbox",htmlFor:"processingEnabled",children:[e.jsx("input",{id:"processingEnabled",type:"checkbox",checked:v,disabled:x||F,onChange:t=>{Y(t.target.checked)}}),"Clean up transcripts with AI"]}),e.jsx("p",{className:"settings-muted",children:x?"Checking post-processing setting...":"When enabled, Air Keys uses Gemini to remove fillers and smooth phrasing."}),v?e.jsxs(e.Fragment,{children:[e.jsxs("form",{className:"settings-form settings-inline-form",onSubmit:J,children:[e.jsx("label",{htmlFor:"geminiKey",children:"Gemini API key"}),e.jsx("input",{id:"geminiKey",type:"password",autoComplete:"off",spellCheck:!1,value:d,onChange:t=>{m(t.target.value),h!=="idle"&&l("idle")},placeholder:"AIza..."}),e.jsxs("div",{className:"settings-actions",children:[e.jsx("button",{type:"submit",disabled:h==="saving",children:H}),e.jsx("button",{type:"button",onClick:Q,children:"Clear key"})]})]}),e.jsxs("p",{className:"settings-status",children:["Stored key:"," ",e.jsx("strong",{children:M?"checking...":P?"present":"not set"})]})]}):null]}),E?e.jsx("p",{className:"settings-error",children:E}):null,e.jsxs("p",{className:"settings-footer",children:["Air Keys v",G]})]})}function te(){return e.jsx(ee,{})}Z.createRoot(document.getElementById("root")).render(e.jsx(s.StrictMode,{children:e.jsx(te,{})}));
