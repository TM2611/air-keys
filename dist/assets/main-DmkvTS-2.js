import{r as a,j as e,i as l,c as S}from"./core-CJ1JWWxS.js";function d(){return typeof window>"u"?!1:typeof window.__TAURI_INTERNALS__?.invoke=="function"}function p(t){return t instanceof Error&&t.message?t.message:typeof t=="string"&&t.length>0?t:"Unknown error"}function x(){const[t,o]=a.useState(""),[m,f]=a.useState(!1),[g,y]=a.useState(!0),[i,r]=a.useState("idle"),[h,n]=a.useState(""),c=async()=>{y(!0);try{if(!d())throw new Error("Tauri runtime unavailable. Open this UI from the Air Keys tray app.");const s=await l("has_deepgram_api_key");f(s)}finally{y(!1)}};a.useEffect(()=>{const s=window.setTimeout(()=>{c().catch(u=>{r("error"),n(p(u))})},0);return()=>window.clearTimeout(s)},[]);const v=a.useMemo(()=>{switch(i){case"saving":return"Saving...";case"saved":return"Saved";default:return"Save key"}},[i]);async function w(s){if(s.preventDefault(),!t.trim()){r("error"),n("Enter a Deepgram API key before saving.");return}try{if(r("saving"),n(""),!d())throw new Error("Tauri runtime unavailable. Open this UI from the Air Keys tray app.");await l("save_deepgram_api_key",{apiKey:t}),o(""),await c(),r("saved")}catch(u){r("error"),n(`Air Keys could not save the API key: ${p(u)}`)}}async function k(){try{if(!d())throw new Error("Tauri runtime unavailable. Open this UI from the Air Keys tray app.");await l("clear_deepgram_api_key"),o(""),r("idle"),n(""),await c()}catch(s){r("error"),n(`Air Keys could not clear the API key: ${p(s)}`)}}return e.jsxs("main",{className:"settings-shell",children:[e.jsx("h1",{children:"Air Keys settings"}),e.jsx("p",{className:"settings-help",children:"Air Keys runs from the system tray. Set your Deepgram API key here."}),e.jsxs("form",{className:"settings-form",onSubmit:w,children:[e.jsx("label",{htmlFor:"deepgramKey",children:"Deepgram API key"}),e.jsx("input",{id:"deepgramKey",type:"password",autoComplete:"off",spellCheck:!1,value:t,onChange:s=>{o(s.target.value),i!=="idle"&&r("idle")},placeholder:"dg_live_..."}),e.jsxs("div",{className:"settings-actions",children:[e.jsx("button",{type:"submit",disabled:i==="saving",children:v}),e.jsx("button",{type:"button",onClick:k,children:"Clear key"})]})]}),e.jsxs("p",{className:"settings-status",children:["Stored key:"," ",e.jsx("strong",{children:g?"checking...":m?"present":"not set"})]}),h?e.jsx("p",{className:"settings-error",children:h}):null]})}function j(){return e.jsx(x,{})}S.createRoot(document.getElementById("root")).render(e.jsx(a.StrictMode,{children:e.jsx(j,{})}));
